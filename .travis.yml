dist: xenial
language: bash
before_install:
  - | 
    if git diff --name-only $TRAVIS_COMMIT_RANGE | grep -qvE 'dartLangSpec.tex'; then
      echo "dartLangSpex.tex wasn't changed; skipping spec PDF build"
      exit 0
    else
      sudo apt-get update -qq
      sudo apt-get install texlive-full
    fi
  - echo '* install completed'
script:
  - cd specification
  - make
  - mkdir build
  - cp dartLangSpec.pdf build/DartLanguageSpecificationDraft.pdf
deploy:
  provider: gcs
  access_key_id: encrypted_dbbec1ffce82_iv
  secret_access_key: encrypted_dbbec1ffce82_key
  bucket: dart-specification
  acl: public-read
  local-dir: build
  skip_cleanup: true
  on:
    repo: dart-lang/language
    branch: testmaster
